import { Fragment, useEffect, useState } from "react";
import { Dialog, Disclosure, Popover, Transition } from "@headlessui/react";
import { Bars3Icon, XMarkIcon } from "@heroicons/react/24/outline";
import { ChevronDownIcon } from "@heroicons/react/20/solid";
import Icon from "./atoms/Icon";
import { Address, ComplexImage } from "../types/autogen";
import { twMerge } from "tailwind-merge";
import DoctorFilterSearch from "./search/DoctorFilterSearch";
import MobilePanel from "./MobilePanel";
import { ResultsCount } from "@yext/search-ui-react";
import SearchPanel from "./search/SearchPanel";
import FacetPopover from "./search/FacetPopover";
import { useSearchState } from "@yext/search-headless-react";

export interface HeaderProps {
  headerLogoURL?: string;
  locations?: {
    name: string;
    address: Address;
    slug: string;
  }[];
  specialties?: {
    name: string;
    slug: string;
  }[];
  locator?: boolean;
}

const renderPopover = ({
  title,
  subtitle,
  links,
  featuredSection,
}: {
  title: string;
  subtitle?: string;
  links: { name: string; slug: string }[];
  featuredSection?: {
    title?: string;
    image?: ComplexImage;
    description?: string;
    cta?: {
      text: string;
      link: string;
    };
  };
}) => {
  return (
    <Popover key={title} className="flex">
      {({ open }) => (
        <>
          <div className="flex">
            <Popover.Button
              className={twMerge(
                open
                  ? "border-cta-green text-cta-green "
                  : "border-transparent text-green hover:text-cta-green",
                "relative -mb-px flex items-center border-b-2 pt-px text-sm font-medium transition-colors duration-200 ease-out outline-none"
              )}
            >
              {title}
            </Popover.Button>
          </div>
          <Transition
            as={Fragment}
            enter="transition ease-out duration-200"
            enterFrom="opacity-0"
            enterTo="opacity-100"
            leave="transition ease-in duration-150"
            leaveFrom="opacity-100"
            leaveTo="opacity-0"
          >
            <Popover.Panel className="absolute inset-x-0 top-full text-sm text-zinc-900 shadow">
              <div className="relative bg-white">
                <div className="mx-auto max-w-7xl px-8">
                  <div className="grid grid-cols-2 gap-x-8 py-8">
                    {featuredSection && (
                      <div className=" relative text-base sm:text-sm">
                        <div className="h-72 aspect-h-1 aspect-w-1 overflow-hidden rounded-lg bg-gray-100 group-hover:opacity-75">
                          {featuredSection.image?.image?.url && (
                            <img
                              src={featuredSection.image?.image?.url}
                              // alt={item.imageAlt}
                              className="object-cover object-center"
                            />
                          )}
                        </div>
                        <div className="mt-6 block font-medium text-zinc-900">
                          {featuredSection.title}
                        </div>
                        <p aria-hidden="true" className="mt-1">
                          {featuredSection.description}
                        </p>
                        <div className="flex justify-center my-4">
                          <a
                            className="px-4 py-2 top-full text-white bg-cta-green rounded-lg  text-sm hover:bg-green-900"
                            href={`${featuredSection.cta?.link}`}
                          >
                            {featuredSection.cta?.text}
                          </a>
                        </div>
                      </div>
                    )}
                    <div>
                      <div className=" pb-8 text-xl text-green">{subtitle}</div>
                      <div className="row-start-1 grid grid-cols-3 gap-x-8 gap-y-6 text-sm">
                        {links.map((link) => (
                          <div key={link.name} className="flex">
                            <a
                              href={`/${link.slug}`}
                              className="text-dark-gray hover:text-gray-800 hover:underline"
                            >
                              {link.name}
                            </a>
                          </div>
                        ))}
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </Popover.Panel>
          </Transition>
        </>
      )}
    </Popover>
  );
};

export default function Header({
  headerLogoURL,
  locations,
  specialties,
  locator,
}: HeaderProps) {
  const [mobileMenuOpen, setMobileMenuOpen] = useState(false);
  const [mobileSearchOpen, setMobileSearchOpen] = useState(false);
  const [searchText, setSearchText] = useState("Specialty, doctor...");
  const [searchPanelOpen, setSearchPanelOpen] = useState(false);

  const staticFilters = useSearchState((state) => state.filters.static);

  useEffect(() => {
    if (staticFilters?.length) {
      const specialtyFilter = staticFilters.find(
        (f) => f.filter.fieldId === "taxonomy_relatedSpecialties.name"
      );
      const doctorFilter = staticFilters.find(
        (f) => f.filter.fieldId === "name"
      );

      if (specialtyFilter) {
        setSearchText(specialtyFilter.displayName ?? "");
      } else if (doctorFilter) {
        setSearchText(doctorFilter.displayName ?? "");
      } else {
        setSearchText("Specialty, doctor...");
      }
    }
  }, [staticFilters]);

  return (
    <header className="fixed top-0 right-0 left-0 z-10">
      <SearchPanel open={searchPanelOpen} toggleOpen={setSearchPanelOpen} />
      <div className="w-full h-12 px-12 py-1 bg-light-green justify-end items-center gap-4 inline-flex">
        <div className="justify-start items-center gap-7 flex">
          <div className="text-neutral-800 text-xs font-bold uppercase leading-tight tracking-wide whitespace-nowrap">
            For Medical Providers
          </div>
          <div className="justify-center items-center gap-1 flex">
            <div className="w-6 h-6 p-px justify-center items-center flex">
              <div className="w-5 h-5 relative">
                <svg
                  width="22"
                  height="22"
                  viewBox="0 0 22 22"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M18.032 7.83645C16.2968 7.83666 14.8214 9.10299 14.5581 10.8181C14.2948 12.5331 15.3223 14.1838 16.9775 14.7045V15.5696C16.9749 17.7039 15.2453 19.4336 13.1109 19.4361H12.7594C10.9932 19.4256 9.45496 18.2283 9.01134 16.5186C11.0194 16.1317 12.6574 14.6817 13.2849 12.7354L13.7067 11.4348C13.8107 11.1116 13.793 10.7616 13.6568 10.4506L15.0305 6.216C15.4176 5.0399 15.2117 3.74921 14.478 2.75193C13.9006 1.94686 13.0317 1.39899 12.0565 1.225V1.15785C12.0565 0.769576 11.7417 0.454834 11.3534 0.454834H10.6504C9.87392 0.454834 9.2444 1.08432 9.2444 1.86087V2.56388C9.2444 3.3404 9.87388 3.96992 10.6504 3.96992H11.3534C11.686 3.96985 11.973 3.73683 12.0413 3.41136C12.8802 3.7641 13.3073 4.70208 13.0227 5.56642L11.6518 9.79677C11.3577 9.96868 11.1367 10.2424 11.0307 10.5662L10.6089 11.8668C10.2352 13.0274 9.15438 13.8137 7.93504 13.812H7.74137C6.52176 13.8142 5.44043 13.0282 5.06607 11.8675L4.64427 10.5669C4.5384 10.2432 4.31756 9.96962 4.0235 9.79781L2.65262 5.56677C2.36793 4.70184 2.79576 3.76334 3.63543 3.41098C3.70362 3.73655 3.99067 3.96978 4.32332 3.96988H5.02633C5.80285 3.96988 6.43237 3.3404 6.43237 2.56385V1.86087C6.43237 1.08435 5.80288 0.454834 5.02633 0.454834H4.32332C3.93504 0.454834 3.6203 0.769576 3.6203 1.15785V1.22427C2.64429 1.39573 1.77474 1.94387 1.19915 2.75051C0.463303 3.74734 0.257142 5.03934 0.646214 6.21565L2.02025 10.4474C1.88304 10.7588 1.86455 11.1097 1.96823 11.4337L2.39003 12.7343C3.04096 14.7542 4.77638 16.2336 6.87384 16.5566C7.35258 19.4345 9.84192 21.5445 12.7594 21.5451H13.1109C16.4096 21.5414 19.0828 18.8682 19.0865 15.5695V14.7045C20.7417 14.1837 21.7692 12.5331 21.5059 10.818C21.2426 9.10295 19.7672 7.83666 18.032 7.83645ZM4.32332 1.15785H5.02633C5.41461 1.15785 5.72935 1.47259 5.72935 1.86087V2.56388C5.72935 2.95216 5.41461 3.2669 5.02633 3.2669H4.32332V1.15785ZM10.6504 3.26686C10.2621 3.26686 9.94738 2.95212 9.94738 2.56385V1.86087C9.94738 1.47259 10.2621 1.15785 10.6504 1.15785H11.3534V3.26686H10.6504ZM13.6912 5.78296C13.8965 5.15303 13.8387 4.46687 13.5309 3.88018C13.2231 3.29348 12.6914 2.85596 12.0564 2.66688V1.94065C12.9213 2.13886 13.6633 2.69096 14.1016 3.46244C14.54 4.23392 14.6344 5.15396 14.3619 5.99839L13.1225 9.81853C13.0232 9.75319 12.9159 9.70072 12.8033 9.66248C12.6904 9.62767 12.5734 9.60713 12.4554 9.6013L13.6912 5.78296ZM1.76787 3.16352C2.21243 2.54018 2.87252 2.10402 3.6203 1.9396V2.66688C2.98533 2.8559 2.45364 3.29334 2.14584 3.88C1.83804 4.46667 1.78019 5.15275 1.98545 5.78261L3.22134 9.60137C3.10325 9.60713 2.98634 9.62767 2.87335 9.66255C2.76116 9.70075 2.65418 9.7528 2.5549 9.81756L1.31477 5.99842C0.99656 5.03594 1.16552 3.97887 1.76787 3.16352ZM3.06001 12.5181L2.63822 11.2176C2.54633 10.9751 2.59536 10.7018 2.76574 10.5064C2.93613 10.311 3.20024 10.2252 3.45294 10.2832C3.70563 10.3412 3.90586 10.5336 3.97394 10.7838L4.39574 12.0844C4.86362 13.536 6.21621 14.5187 7.74137 14.515H7.93504C9.45955 14.5179 10.8112 13.5354 11.2789 12.0844L11.7007 10.7838C11.8205 10.4145 12.217 10.2121 12.5863 10.3319C12.9556 10.4517 13.158 10.8482 13.0382 11.2176L12.6164 12.5181C11.9618 14.5497 10.0694 15.9253 7.93504 15.9211H7.74137C5.60713 15.9248 3.71493 14.5494 3.06001 12.5181ZM18.3835 15.5695C18.3802 18.4801 16.0215 20.8388 13.1109 20.8421H12.7594C10.2526 20.8421 8.093 19.0756 7.59618 16.6184C7.6447 16.6184 7.69248 16.624 7.74134 16.624H7.93501C8.06226 16.624 8.18809 16.6174 8.31322 16.6089C8.80639 18.6685 10.6416 20.1256 12.7594 20.139H13.1109C15.6334 20.1361 17.6775 18.092 17.6805 15.5695V14.8486C17.9142 14.8725 18.1497 14.8725 18.3835 14.8486L18.3835 15.5695ZM18.032 14.1635C16.479 14.1635 15.2199 12.9045 15.2199 11.3515C15.2199 9.79847 16.479 8.53947 18.032 8.53947C19.585 8.53947 20.844 9.79847 20.844 11.3515C20.8423 12.9038 19.5843 14.1618 18.032 14.1635Z"
                    fill="#448539"
                  />
                  <path
                    d="M18.032 9.59399C17.0613 9.59399 16.2744 10.3808 16.2744 11.3515C16.2744 12.3222 17.0613 13.109 18.032 13.109C19.0026 13.109 19.7895 12.3222 19.7895 11.3515C19.7883 10.3813 19.0021 9.59514 18.032 9.59399ZM18.032 12.406C17.4496 12.406 16.9775 11.9339 16.9775 11.3515C16.9775 10.7691 17.4496 10.297 18.032 10.297C18.6144 10.297 19.0865 10.7691 19.0865 11.3515C19.0865 11.9339 18.6144 12.406 18.032 12.406Z"
                    fill="#448539"
                  />
                </svg>
              </div>
            </div>
            <div className="text-neutral-800 text-xs font-bold uppercase leading-tight tracking-wide">
              Careers
            </div>
          </div>
          <div className="justify-center items-center gap-1 flex">
            <div className="w-6 h-6 p-px justify-center items-center flex">
              <div className="w-5 h-5 relative flex-col justify-start items-start flex">
                <div className="w-5 h-5 relative">
                  <svg
                    width="24"
                    height="24"
                    viewBox="0 0 24 24"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      d="M13.9255 5.90442H12.9686V4.94751C12.9686 4.86291 12.935 4.78178 12.8752 4.72196C12.8154 4.66215 12.7343 4.62854 12.6497 4.62854H11.3738C11.2892 4.62854 11.2081 4.66215 11.1482 4.72196C11.0884 4.78178 11.0548 4.86291 11.0548 4.94751V5.90442H10.0979C10.0133 5.90442 9.93217 5.93802 9.87235 5.99784C9.81254 6.05766 9.77893 6.13879 9.77893 6.22339V7.49927C9.77893 7.58386 9.81254 7.66499 9.87235 7.72481C9.93217 7.78463 10.0133 7.81824 10.0979 7.81824H11.0548V8.77515C11.0548 8.85974 11.0884 8.94087 11.1482 9.00069C11.2081 9.06051 11.2892 9.09412 11.3738 9.09412H12.6497C12.7343 9.09412 12.8154 9.06051 12.8752 9.00069C12.935 8.94087 12.9686 8.85974 12.9686 8.77515V7.81824H13.9255C14.0101 7.81824 14.0913 7.78463 14.1511 7.72481C14.2109 7.66499 14.2445 7.58386 14.2445 7.49927V6.22339C14.2445 6.13879 14.2109 6.05766 14.1511 5.99784C14.0913 5.93802 14.0101 5.90442 13.9255 5.90442ZM13.6066 7.1803H12.6497C12.5651 7.1803 12.4839 7.2139 12.4241 7.27372C12.3643 7.33354 12.3307 7.41467 12.3307 7.49927V8.45618H11.6927V7.49927C11.6927 7.41467 11.6591 7.33354 11.5993 7.27372C11.5395 7.2139 11.4584 7.1803 11.3738 7.1803H10.4169V6.54236H11.3738C11.4584 6.54236 11.5395 6.50875 11.5993 6.44893C11.6591 6.38912 11.6927 6.30798 11.6927 6.22339V5.26648H12.3307V6.22339C12.3307 6.30798 12.3643 6.38912 12.4241 6.44893C12.4839 6.50875 12.5651 6.54236 12.6497 6.54236H13.6066V7.1803Z"
                      fill="#448539"
                    />
                    <path
                      d="M20.8567 7.61406C20.8632 7.55794 20.8664 7.5015 20.8663 7.44501C20.8648 7.15263 20.7633 6.86956 20.5789 6.64273C20.3944 6.4159 20.1379 6.25893 19.852 6.19783C19.5286 6.13627 19.1938 6.19986 18.9155 6.37573C18.6372 6.55161 18.4361 6.82664 18.3528 7.14517L16.9494 11.1833C16.9286 11.1916 16.9083 11.2012 16.8888 11.212L14.0691 12.8643C13.6376 13.1178 13.2797 13.4794 13.0308 13.9135C12.7819 14.3476 12.6505 14.8391 12.6497 15.3395V18.3442C12.5651 18.3442 12.4839 18.3778 12.4241 18.4376C12.3643 18.4974 12.3307 18.5786 12.3307 18.6632V21.2149C12.3307 21.2995 12.3643 21.3807 12.4241 21.4405C12.4839 21.5003 12.5651 21.5339 12.6497 21.5339H17.1152C17.1998 21.5339 17.281 21.5003 17.3408 21.4405C17.4006 21.3807 17.4342 21.2995 17.4342 21.2149V18.6632C17.4342 18.5786 17.4006 18.4974 17.3408 18.4376C17.281 18.3778 17.1998 18.3442 17.1152 18.3442V17.6425C17.1158 17.5077 17.1445 17.3746 17.1994 17.2516C17.2543 17.1286 17.3343 17.0184 17.4342 16.928L19.5904 15.011C19.8263 14.8046 19.9951 14.5325 20.0753 14.2295L21.4596 9.05261C21.4892 8.94451 21.5042 8.83295 21.5043 8.72089C21.503 8.49579 21.4425 8.27499 21.3288 8.08069C21.2152 7.8864 21.0524 7.72546 20.8567 7.61406ZM18.9621 7.33337C19.0012 7.16841 19.1011 7.02427 19.2418 6.92968C19.3825 6.8351 19.5537 6.79701 19.7212 6.82302C19.8642 6.85296 19.9926 6.93106 20.0849 7.04427C20.1772 7.15748 20.2278 7.29894 20.2284 7.44501V7.45139C19.9435 7.45667 19.6681 7.55488 19.4441 7.73107C19.2201 7.90725 19.0598 8.15177 18.9876 8.42743L18.0977 11.1738C17.9629 11.1099 17.8185 11.0689 17.6702 11.0526L18.9621 7.33337ZM16.7963 20.896H12.9686V18.9821H16.7963V20.896ZM20.844 8.88675L19.4565 14.0668C19.4085 14.2468 19.3086 14.4088 19.1694 14.5325L17.01 16.4495C16.8429 16.6002 16.7092 16.7842 16.6174 16.9896C16.5257 17.1951 16.478 17.4175 16.4773 17.6425V18.3442H13.2876V15.3395C13.2892 14.9503 13.3917 14.5682 13.5851 14.2306C13.7786 13.8929 14.0563 13.6112 14.3912 13.4129L17.2077 11.7639C17.2804 11.7215 17.3606 11.694 17.4439 11.6828C17.5272 11.6716 17.6119 11.677 17.6931 11.6986C17.7743 11.7203 17.8505 11.7577 17.9172 11.8089C17.9838 11.86 18.0398 11.9239 18.0817 11.9967C18.1646 12.1441 18.1874 12.3177 18.1455 12.4815C18.1234 12.5624 18.0855 12.6381 18.034 12.7044C17.9826 12.7706 17.9186 12.826 17.8457 12.8675L16.018 13.9233C15.9486 13.9674 15.8989 14.0367 15.8793 14.1166C15.8597 14.1965 15.8718 14.2809 15.9129 14.3521C15.9541 14.4233 16.0212 14.4759 16.1002 14.4988C16.1792 14.5217 16.2641 14.5132 16.3369 14.4751L18.1646 13.4193C18.3107 13.3364 18.4388 13.2251 18.5412 13.092C18.6436 12.9589 18.7184 12.8067 18.7611 12.6442C18.8479 12.3178 18.8021 11.9704 18.6335 11.6777L18.6144 11.649L19.6 8.60925C19.6392 8.44429 19.739 8.30015 19.8797 8.20556C20.0204 8.11098 20.1916 8.07289 20.3592 8.09889C20.5021 8.12884 20.6305 8.20694 20.7228 8.32015C20.8151 8.43336 20.8658 8.57481 20.8663 8.72089C20.8674 8.77699 20.8599 8.83293 20.844 8.88675Z"
                      fill="#448539"
                    />
                    <path
                      d="M11.3738 18.3442V15.3395C11.3729 14.8391 11.2416 14.3476 10.9926 13.9135C10.7437 13.4794 10.3858 13.1178 9.95435 12.8643L7.13466 11.2089C7.11552 11.1993 7.09319 11.1929 7.07405 11.1833L5.68016 7.1675C5.59914 6.84432 5.39803 6.56415 5.11774 6.38401C4.83746 6.20387 4.49906 6.1373 4.17143 6.19784C3.8855 6.25893 3.62904 6.4159 3.44456 6.64273C3.26007 6.86956 3.15865 7.15263 3.1571 7.44501C3.15702 7.5015 3.16022 7.55794 3.16667 7.61406C2.97107 7.72546 2.80825 7.8864 2.69458 8.0807C2.58092 8.27499 2.52042 8.49579 2.51917 8.72089C2.51978 8.83272 2.5337 8.94408 2.56063 9.05262L3.94815 14.2263C4.02744 14.5306 4.19636 14.8039 4.43298 15.011L6.58603 16.928C6.68693 17.0177 6.76777 17.1278 6.82328 17.2509C6.87879 17.374 6.90772 17.5074 6.90819 17.6425V18.3442C6.82359 18.3442 6.74246 18.3778 6.68264 18.4376C6.62282 18.4974 6.58922 18.5786 6.58922 18.6632V21.2149C6.58922 21.2995 6.62282 21.3807 6.68264 21.4405C6.74246 21.5003 6.82359 21.5339 6.90819 21.5339H11.3738C11.4584 21.5339 11.5395 21.5003 11.5993 21.4405C11.6591 21.3807 11.6927 21.2995 11.6927 21.2149V18.6632C11.6927 18.5786 11.6591 18.4974 11.5993 18.4376C11.5395 18.3778 11.4584 18.3442 11.3738 18.3442ZM3.79504 7.44501C3.79544 7.29938 3.84564 7.15827 3.93732 7.04512C4.029 6.93197 4.15663 6.8536 4.29902 6.82302C4.47115 6.79803 4.64637 6.83905 4.78953 6.93784C4.93269 7.03663 5.03321 7.1859 5.07092 7.3557L6.35318 11.0526C6.20496 11.0689 6.0605 11.1099 5.92576 11.1738L5.04222 8.44338C4.97031 8.165 4.8097 7.91761 4.58468 7.73862C4.35966 7.55964 4.08247 7.45881 3.79504 7.45139V7.44501ZM7.01026 16.4495L4.85402 14.5325C4.71401 14.4081 4.6141 14.2449 4.56695 14.0636L3.17624 8.88675C3.16304 8.83247 3.15661 8.77675 3.1571 8.72089C3.1575 8.57526 3.2077 8.43415 3.29938 8.321C3.39106 8.20785 3.5187 8.12948 3.66108 8.0989C3.832 8.07324 4.0063 8.11326 4.14891 8.2109C4.29153 8.30855 4.39188 8.45657 4.42979 8.6252L5.40903 11.649L5.38989 11.6777C5.22135 11.9704 5.17548 12.3179 5.2623 12.6442C5.30501 12.8067 5.37978 12.9589 5.48222 13.092C5.58466 13.2251 5.71269 13.3364 5.85878 13.4193L7.68647 14.4751C7.75937 14.5132 7.84419 14.5217 7.9232 14.4988C8.00221 14.4759 8.06931 14.4233 8.11048 14.3521C8.15165 14.2809 8.16371 14.1965 8.14414 14.1166C8.12456 14.0367 8.07487 13.9674 8.00544 13.9233L6.17775 12.8675C6.10486 12.826 6.04085 12.7706 5.98941 12.7044C5.93796 12.6381 5.90007 12.5624 5.87792 12.4815C5.83601 12.3177 5.85886 12.1441 5.94171 11.9967C5.98339 11.924 6.03897 11.8603 6.10529 11.8091C6.1716 11.7579 6.24736 11.7203 6.32822 11.6983C6.40908 11.6764 6.49346 11.6706 6.57656 11.6813C6.65965 11.692 6.73982 11.719 6.8125 11.7607L9.63219 13.4129C9.96709 13.6112 10.2448 13.8929 10.4383 14.2306C10.6317 14.5682 10.7342 14.9503 10.7358 15.3395V18.3442H7.54613V17.6425C7.54558 17.4171 7.49759 17.1945 7.40526 16.9889C7.31293 16.7834 7.17834 16.5996 7.01026 16.4495ZM11.0548 20.896H7.22716V18.9821H11.0548V20.896Z"
                      fill="#448539"
                    />
                    <path
                      d="M16.5242 3.39476C16.228 3.09813 15.8763 2.8628 15.4892 2.70225C15.102 2.5417 14.687 2.45908 14.2679 2.45911C13.8487 2.45914 13.4337 2.54182 13.0466 2.70243C12.6594 2.86303 12.3078 3.0984 12.0117 3.39508C11.7156 3.0984 11.364 2.86302 10.9769 2.70242C10.5897 2.54183 10.1747 2.45916 9.75562 2.45916C9.3365 2.45916 8.9215 2.54183 8.53437 2.70242C8.14724 2.86302 7.79559 3.0984 7.49955 3.39508C6.90254 3.99336 6.56726 4.80404 6.56726 5.64924C6.56726 6.49443 6.90254 7.30511 7.49955 7.9034L11.7865 12.1903C11.8463 12.2501 11.9274 12.2837 12.012 12.2837C12.0966 12.2837 12.1777 12.2501 12.2375 12.1903L16.5245 7.9034C17.1215 7.30501 17.4567 6.49426 17.4566 5.64901C17.4566 4.80376 17.1212 3.99306 16.5242 3.39476ZM12.0117 11.5138L7.95025 7.45237C7.59368 7.09532 7.35098 6.64057 7.25283 6.1456C7.15467 5.65064 7.20547 5.13768 7.3988 4.67158C7.59213 4.20548 7.91931 3.80716 8.33898 3.52698C8.75865 3.2468 9.25197 3.09733 9.75658 3.09748C10.0918 3.09633 10.4238 3.16193 10.7334 3.29046C11.043 3.41899 11.3239 3.60788 11.5597 3.8461L11.7862 4.07257C11.846 4.13237 11.9271 4.16596 12.0117 4.16596C12.0963 4.16596 12.1774 4.13237 12.2372 4.07257L12.4643 3.84546C12.7011 3.60823 12.9824 3.42002 13.292 3.29161C13.6016 3.1632 13.9335 3.0971 14.2687 3.0971C14.6039 3.0971 14.9358 3.1632 15.2454 3.29161C15.5551 3.42002 15.8363 3.60823 16.0731 3.84546C16.5509 4.32391 16.8193 4.97243 16.8193 5.6486C16.8193 6.32476 16.5509 6.97329 16.0731 7.45173L12.0117 11.5138Z"
                      fill="#448539"
                    />
                  </svg>
                </div>
              </div>
            </div>
            <div className="text-neutral-800 text-xs font-bold uppercase leading-tight tracking-wide">
              DONATE
            </div>
          </div>
          <div className="justify-center items-center gap-1 flex">
            <div className="w-6 h-6 p-px justify-center items-center flex">
              <div className="w-5 h-5 relative flex-col justify-start items-start flex">
                <div className="w-4 h-5 relative">
                  <svg
                    width="24"
                    height="24"
                    viewBox="0 0 24 24"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      d="M10.8007 6.72906C11.2031 6.72906 11.4599 6.92418 11.4599 7.05865C11.4599 7.14607 11.4946 7.2299 11.5564 7.29171C11.6182 7.35352 11.7021 7.38824 11.7895 7.38824C11.8769 7.38824 11.9607 7.35352 12.0225 7.29171C12.0843 7.2299 12.1191 7.14607 12.1191 7.05865C12.1191 6.59031 11.7041 6.21128 11.1303 6.10284V5.7403C11.1303 5.65288 11.0956 5.56905 11.0338 5.50724C10.972 5.44543 10.8881 5.41071 10.8007 5.41071C10.7133 5.41071 10.6295 5.44543 10.5676 5.50724C10.5058 5.56905 10.4711 5.65288 10.4711 5.7403V6.10284C9.8973 6.21062 9.48235 6.58965 9.48235 7.05865C9.48235 7.61302 10.0614 8.04742 10.8007 8.04742C11.2031 8.04742 11.4599 8.24254 11.4599 8.37701C11.4599 8.51149 11.2031 8.7066 10.8007 8.7066C10.3983 8.7066 10.1415 8.51149 10.1415 8.37701C10.1415 8.2896 10.1068 8.20577 10.045 8.14396C9.98318 8.08215 9.89935 8.04742 9.81194 8.04742C9.72452 8.04742 9.64069 8.08215 9.57888 8.14396C9.51707 8.20577 9.48235 8.2896 9.48235 8.37701C9.48235 8.84536 9.8973 9.22439 10.4711 9.33282V9.69537C10.4711 9.78279 10.5058 9.86662 10.5676 9.92843C10.6295 9.99024 10.7133 10.025 10.8007 10.025C10.8881 10.025 10.972 9.99024 11.0338 9.92843C11.0956 9.86662 11.1303 9.78279 11.1303 9.69537V9.33282C11.7041 9.22505 12.1191 8.84602 12.1191 8.37701C12.1191 7.82264 11.54 7.38824 10.8007 7.38824C10.3983 7.38824 10.1415 7.19313 10.1415 7.05865C10.1415 6.92418 10.3983 6.72906 10.8007 6.72906Z"
                      fill="#448539"
                    />
                    <path
                      d="M9.48235 4.75153H12.1191C12.2065 4.75153 12.2903 4.7168 12.3521 4.65499C12.4139 4.59318 12.4487 4.50935 12.4487 4.42194C12.4487 4.33452 12.4139 4.25069 12.3521 4.18888C12.2903 4.12707 12.2065 4.09235 12.1191 4.09235H9.48235C9.39493 4.09235 9.3111 4.12707 9.24929 4.18888C9.18748 4.25069 9.15276 4.33452 9.15276 4.42194C9.15276 4.50935 9.18748 4.59318 9.24929 4.65499C9.3111 4.7168 9.39493 4.75153 9.48235 4.75153Z"
                      fill="#448539"
                    />
                    <path
                      d="M9.48235 11.3433H12.1191C12.2065 11.3433 12.2903 11.3086 12.3521 11.2468C12.4139 11.185 12.4487 11.1011 12.4487 11.0137C12.4487 10.9263 12.4139 10.8425 12.3521 10.7807C12.2903 10.7189 12.2065 10.6841 12.1191 10.6841H9.48235C9.39493 10.6841 9.3111 10.7189 9.24929 10.7807C9.18748 10.8425 9.15276 10.9263 9.15276 11.0137C9.15276 11.1011 9.18748 11.185 9.24929 11.2468C9.3111 11.3086 9.39493 11.3433 9.48235 11.3433Z"
                      fill="#448539"
                    />
                    <path
                      d="M6.84563 15.2984H14.7558C14.8432 15.2984 14.927 15.2637 14.9888 15.2019C15.0506 15.1401 15.0854 15.0562 15.0854 14.9688C15.0854 14.8814 15.0506 14.7976 14.9888 14.7358C14.927 14.6739 14.8432 14.6392 14.7558 14.6392H6.84563C6.75821 14.6392 6.67438 14.6739 6.61257 14.7358C6.55076 14.7976 6.51604 14.8814 6.51604 14.9688C6.51604 15.0562 6.55076 15.1401 6.61257 15.2019C6.67438 15.2637 6.75821 15.2984 6.84563 15.2984Z"
                      fill="#448539"
                    />
                    <path
                      d="M6.84563 13.98H14.7558C14.8432 13.98 14.927 13.9453 14.9888 13.8835C15.0506 13.8217 15.0854 13.7379 15.0854 13.6505C15.0854 13.563 15.0506 13.4792 14.9888 13.4174C14.927 13.3556 14.8432 13.3209 14.7558 13.3209H6.84563C6.75821 13.3209 6.67438 13.3556 6.61257 13.4174C6.55076 13.4792 6.51604 13.563 6.51604 13.6505C6.51604 13.7379 6.55076 13.8217 6.61257 13.8835C6.67438 13.9453 6.75821 13.98 6.84563 13.98Z"
                      fill="#448539"
                    />
                    <path
                      d="M13.4374 15.9576H6.84563C6.75821 15.9576 6.67438 15.9923 6.61257 16.0541C6.55076 16.1159 6.51604 16.1998 6.51604 16.2872C6.51604 16.3746 6.55076 16.4584 6.61257 16.5202C6.67438 16.582 6.75821 16.6168 6.84563 16.6168H13.4374C13.5248 16.6168 13.6087 16.582 13.6705 16.5202C13.7323 16.4584 13.767 16.3746 13.767 16.2872C13.767 16.1998 13.7323 16.1159 13.6705 16.0541C13.6087 15.9923 13.5248 15.9576 13.4374 15.9576Z"
                      fill="#448539"
                    />
                    <path
                      d="M13.4374 17.2759H6.84563C6.75821 17.2759 6.67438 17.3107 6.61257 17.3725C6.55076 17.4343 6.51604 17.5181 6.51604 17.6055C6.51604 17.6929 6.55076 17.7768 6.61257 17.8386C6.67438 17.9004 6.75821 17.9351 6.84563 17.9351H13.4374C13.5248 17.9351 13.6087 17.9004 13.6705 17.8386C13.7323 17.7768 13.767 17.6929 13.767 17.6055C13.767 17.5181 13.7323 17.4343 13.6705 17.3725C13.6087 17.3107 13.5248 17.2759 13.4374 17.2759Z"
                      fill="#448539"
                    />
                    <path
                      d="M13.4374 11.3433H13.767C13.8544 11.3433 13.9383 11.3086 14.0001 11.2468C14.0619 11.185 14.0966 11.1011 14.0966 11.0137C14.0966 10.9263 14.0619 10.8425 14.0001 10.7807C13.9383 10.7189 13.8544 10.6841 13.767 10.6841H13.4374C13.35 10.6841 13.2662 10.7189 13.2044 10.7807C13.1426 10.8425 13.1078 10.9263 13.1078 11.0137C13.1078 11.1011 13.1426 11.185 13.2044 11.2468C13.2662 11.3086 13.35 11.3433 13.4374 11.3433Z"
                      fill="#448539"
                    />
                    <path
                      d="M7.8344 11.3433H8.16399C8.2514 11.3433 8.33523 11.3086 8.39704 11.2468C8.45885 11.185 8.49358 11.1011 8.49358 11.0137C8.49358 10.9263 8.45885 10.8425 8.39704 10.7807C8.33523 10.7189 8.2514 10.6841 8.16399 10.6841H7.8344C7.74698 10.6841 7.66315 10.7189 7.60134 10.7807C7.53953 10.8425 7.50481 10.9263 7.50481 11.0137C7.50481 11.1011 7.53953 11.185 7.60134 11.2468C7.66315 11.3086 7.74698 11.3433 7.8344 11.3433Z"
                      fill="#448539"
                    />
                    <path
                      d="M13.4374 4.75153H13.767C13.8544 4.75153 13.9383 4.7168 14.0001 4.65499C14.0619 4.59318 14.0966 4.50935 14.0966 4.42194C14.0966 4.33452 14.0619 4.25069 14.0001 4.18888C13.9383 4.12707 13.8544 4.09235 13.767 4.09235H13.4374C13.35 4.09235 13.2662 4.12707 13.2044 4.18888C13.1426 4.25069 13.1078 4.33452 13.1078 4.42194C13.1078 4.50935 13.1426 4.59318 13.2044 4.65499C13.2662 4.7168 13.35 4.75153 13.4374 4.75153Z"
                      fill="#448539"
                    />
                    <path
                      d="M7.8344 4.75153H8.16399C8.2514 4.75153 8.33523 4.7168 8.39704 4.65499C8.45885 4.59318 8.49358 4.50935 8.49358 4.42194C8.49358 4.33452 8.45885 4.25069 8.39704 4.18888C8.33523 4.12707 8.2514 4.09235 8.16399 4.09235H7.8344C7.74698 4.09235 7.66315 4.12707 7.60134 4.18888C7.53953 4.25069 7.50481 4.33452 7.50481 4.42194C7.50481 4.50935 7.53953 4.59318 7.60134 4.65499C7.66315 4.7168 7.74698 4.75153 7.8344 4.75153Z"
                      fill="#448539"
                    />
                    <path
                      d="M17.8759 15.2972V9.34808H20.183C20.2705 9.34808 20.3543 9.31336 20.4161 9.25155C20.4779 9.18974 20.5126 9.10591 20.5126 9.01849V3.74506C20.5126 3.52864 20.47 3.31435 20.3872 3.11441C20.3044 2.91447 20.183 2.73281 20.03 2.57978C19.8769 2.42675 19.6953 2.30537 19.4953 2.22255C19.2954 2.13973 19.0811 2.09711 18.8647 2.09711H5.68109C5.24403 2.09711 4.82487 2.27073 4.51582 2.57978C4.20677 2.88883 4.03314 3.30799 4.03314 3.74506V21.5429C4.0329 21.6081 4.05224 21.6719 4.08868 21.7259C4.12512 21.78 4.17696 21.8219 4.23749 21.8461C4.2766 21.8646 4.3195 21.8736 4.36273 21.8725C4.45029 21.8728 4.5344 21.8384 4.59674 21.7769L5.68109 20.6893L6.76544 21.7769C6.82767 21.8387 6.91179 21.8733 6.99945 21.8733C7.08712 21.8733 7.17123 21.8387 7.23346 21.7769L8.31781 20.6893L9.40216 21.7769C9.46439 21.8387 9.54851 21.8733 9.63617 21.8733C9.72384 21.8733 9.80795 21.8387 9.87018 21.7769L10.9545 20.6893L12.0389 21.7769C12.1011 21.8387 12.1852 21.8733 12.2729 21.8733C12.3606 21.8733 12.4447 21.8387 12.5069 21.7769L13.5913 20.6893L14.6756 21.7769C14.7378 21.8387 14.8219 21.8733 14.9096 21.8733C14.9973 21.8733 15.0814 21.8387 15.1436 21.7769L15.6512 21.2694C16.0633 21.5604 16.5368 21.753 17.0352 21.8322C17.5335 21.9114 18.0433 21.8752 18.5254 21.7262C19.0075 21.5773 19.449 21.3196 19.8158 20.9731C20.1826 20.6266 20.465 20.2006 20.6411 19.7277C20.8172 19.2549 20.8825 18.7479 20.8318 18.2459C20.781 17.7439 20.6157 17.2602 20.3486 16.8321C20.0814 16.4041 19.7195 16.0431 19.2908 15.7769C18.8621 15.5108 18.3781 15.3467 17.8759 15.2972ZM17.8759 3.74506C17.8759 3.48282 17.9801 3.23132 18.1655 3.04589C18.351 2.86046 18.6025 2.75629 18.8647 2.75629C19.1269 2.75629 19.3784 2.86046 19.5639 3.04589C19.7493 3.23132 19.8535 3.48282 19.8535 3.74506V8.6889H17.8759V3.74506ZM14.9096 21.0782L13.8253 19.9905C13.763 19.9288 13.6789 19.8941 13.5913 19.8941C13.5036 19.8941 13.4195 19.9288 13.3572 19.9905L12.2729 21.0782L11.1885 19.9905C11.1263 19.9288 11.0422 19.8941 10.9545 19.8941C10.8669 19.8941 10.7828 19.9288 10.7205 19.9905L9.63617 21.0782L8.55182 19.9905C8.48959 19.9288 8.40548 19.8941 8.31781 19.8941C8.23015 19.8941 8.14603 19.9288 8.0838 19.9905L6.99945 21.0782L5.9151 19.9905C5.85287 19.9288 5.76876 19.8941 5.68109 19.8941C5.59343 19.8941 5.50931 19.9288 5.44709 19.9905L4.69232 20.7486V3.74506C4.69311 3.48306 4.79753 3.23202 4.98279 3.04676C5.16805 2.86149 5.4191 2.75707 5.68109 2.75629H17.5562C17.3371 3.03941 17.2177 3.38704 17.2167 3.74506V15.2972C16.604 15.3576 16.0205 15.5887 15.5327 15.9643C15.0449 16.34 14.6723 16.845 14.4573 17.4219C14.2423 17.9988 14.1936 18.6245 14.3167 19.2278C14.4397 19.8311 14.7297 20.3877 15.1535 20.8343L14.9096 21.0782ZM17.5463 21.2133C17.0248 21.2133 16.5151 21.0587 16.0814 20.769C15.6478 20.4792 15.3099 20.0674 15.1103 19.5856C14.9108 19.1038 14.8585 18.5737 14.9603 18.0622C15.062 17.5507 15.3131 17.0809 15.6819 16.7122C16.0506 16.3434 16.5205 16.0923 17.0319 15.9905C17.5434 15.8888 18.0736 15.941 18.5554 16.1406C19.0372 16.3402 19.449 16.6781 19.7387 17.1117C20.0284 17.5453 20.183 18.0551 20.183 18.5766C20.1821 19.2756 19.904 19.9457 19.4097 20.44C18.9154 20.9343 18.2453 21.2124 17.5463 21.2133Z"
                      fill="#448539"
                    />
                    <path
                      d="M19.1604 17.4855C19.0986 17.4237 19.0148 17.389 18.9274 17.389C18.84 17.389 18.7562 17.4237 18.6944 17.4855L17.0629 19.117L16.3635 18.4176C16.3014 18.3576 16.2181 18.3244 16.1317 18.3251C16.0453 18.3259 15.9626 18.3605 15.9015 18.4216C15.8404 18.4827 15.8057 18.5654 15.805 18.6518C15.8042 18.7382 15.8374 18.8215 15.8975 18.8837L16.8299 19.8161C16.8917 19.8779 16.9755 19.9126 17.0629 19.9126C17.1503 19.9126 17.2341 19.8779 17.2959 19.8161L19.1604 17.9516C19.2222 17.8898 19.2569 17.806 19.2569 17.7186C19.2569 17.6312 19.2222 17.5473 19.1604 17.4855Z"
                      fill="#448539"
                    />
                  </svg>
                </div>
              </div>
            </div>
            <div className="text-neutral-800 text-xs font-bold uppercase leading-tight tracking-wide">
              Pay Bill
            </div>
          </div>
        </div>
      </div>

      <div className="w-full h-20 px-12 py-4 bg-white shadow justify-start items-center gap-12 flex flex-row">
        <a className="min-w-max h-auto" href={"/index.html"}>
          <img className="w-40" src={headerLogoURL} />
        </a>
        <Popover.Group className="ml-8 block lg:self-stretch z-20">
          <div className="flex h-full space-x-8">
            {renderPopover({
              title: "Services",
              subtitle: "Specialties",
              links:
                specialties?.map((specialty) => ({
                  name: specialty.name,
                  slug: specialty.slug,
                })) ?? [],
              featuredSection: {
                image: {
                  image: {
                    url: "https://images.unsplash.com/photo-1532938911079-1b06ac7ceec7?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2532&q=80",
                    alternateText: "doctor",
                    width: 2532,
                    height: 2532,
                  },
                },
                description:
                  "Learn why we are top ranked in 14 adult medical specialties and 8 pediatric subspecialties.",
                cta: {
                  text: "View all services",
                  link: "/search",
                },
              },
            })}
            {renderPopover({
              title: "Locations",
              subtitle: "Featured Locations",
              links:
                locations?.map((location) => ({
                  name: `${location.address.city} - ${location.address.line1}`,
                  slug: location.slug,
                })) ?? [],
              featuredSection: {
                image: {
                  image: {
                    url: "https://images.unsplash.com/photo-1626315869436-d6781ba69d6e?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=2070&q=80",
                    alternateText: "Waiting room",
                    width: 2532,
                    height: 2532,
                  },
                },
                description:
                  "Get access to exceptional clinical services close to where you live, work, and even on your phone.",
                cta: {
                  text: "View all locations",
                  link: "/root.html",
                },
              },
            })}
          </div>
        </Popover.Group>
        <div className="w-full h-12 gap-4 flex justify-end">
          <button
            // href="/search"
            onClick={() => setSearchPanelOpen(true)}
            className="flex items-center space-x-2 hover:underline mx-4"
          >
            <span>Search</span>
            <Icon name="search" height="4" width="4" />
          </button>
          <div className="p-4 bg-white rounded-full border border-neutral-800 justify-end items-center gap-2 flex hover:bg-light-green  text-neutral-800 ">
            <div className="text-center text-s font-bold  leading-normal whitespace-nowrap ">
              Schedule Appointment
            </div>
          </div>
          <div className="p-4 bg-cta-green rounded-full justify-end items-center gap-2 flex hover:bg-primary-green">
            <a href="/guided-doctor-finder" className="text-center text-white text-s font-bold leading-normal whitespace-nowrap">
              Find a Provider
            </a>
          </div>
        </div>
      </div>
    </header>
  );
}
